<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard v2.5</title>
<style>
  body {
    margin: 0;
    background: black;
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
    text-align: center;
  }

  #container {
    display: block;
    padding-top: 50px;
  }

  #time {
    font-size: 60px;
    font-weight: bold;
  }

  #date {
    font-size: 24px;
    margin-top: 10px;
  }

  #weather {
    font-size: 24px;
    margin-top: 20px;
  }

  #version-badge {
    position: fixed;
    top: 12px;
    right: 12px;
    background: rgba(255,255,255,0.1);
    color: #fff;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 13px;
    border: 1px solid rgba(255,255,255,0.2);
    z-index: 9999;
  }
</style>
</head>
<body>

<div id="container">
  <div id="time">--:--</div>
  <div id="date">Loading date...</div>
  <div id="weather">Loading weather...</div>
</div>

<div id="version-badge">v2.5</div>

<script>
// ----- CLOCK -----
var timeEl = document.getElementById('time');
var dateEl = document.getElementById('date');

function updateClock() {
  var now = new Date();
  var hours = now.getHours();
  var minutes = now.getMinutes();
  if(hours > 12) { hours -= 12; }
  if(hours === 0) { hours = 12; }
  if(minutes < 10) { minutes = '0' + minutes; }
  timeEl.innerHTML = hours + ':' + minutes;

  var month = now.getMonth() + 1;
  var day = now.getDate();
  var year = now.getFullYear();
  dateEl.innerHTML = month + '/' + day + '/' + year;
}
setInterval(updateClock, 1000);
updateClock();

// ----- WEATHER -----
var weatherEl = document.getElementById('weather');
var url = "https://wttr.in/Greenfield,MA?format=2&u";

var emojiMap = {
  "ðŸŒ«": "Foggy",
  "â˜€ï¸": "Sunny",
  "ðŸŒ§ï¸": "Rainy",
  "ðŸŒ¨ï¸": "Snowy",
  "ðŸŒ¬ï¸": "Wind",
  "ðŸŒ¡ï¸": "Temp"
};

var windDirMap = {
  "â†–": "NW",
  "â†‘": "N",
  "â†—": "NE",
  "â†’": "E",
  "â†˜": "SE",
  "â†“": "S",
  "â†™": "SW",
  "â†": "W"
};

var plainTextWeather = ""; // will hold parsed version

var xhr = new XMLHttpRequest();
xhr.open('GET', url, true);
xhr.onreadystatechange = function() {
  if(xhr.readyState === 4){
    if(xhr.status === 200){
      var emojiString = xhr.responseText;
      weatherEl.innerText = emojiString; // display emojis

      // ---- convert to plain text ----
      plainTextWeather = emojiString
        .replace(/ðŸŒ«|â˜€ï¸|ðŸŒ§ï¸|ðŸŒ¨ï¸|ðŸŒ¬ï¸|ðŸŒ¡ï¸/g, function(match){ return emojiMap[match]; })
        .replace(/[â†–â†‘â†—â†’â†˜â†“â†™â†]/g, function(match){ return windDirMap[match]; })
        .replace(/\+/g,''); // optional cleanup

      console.log("Plain text weather:", plainTextWeather); // behind the scenes
    } else {
      weatherEl.innerText = "Weather unavailable";
      plainTextWeather = "Weather unavailable";
    }
  }
};
xhr.send();
</script>

</body>
</html>
